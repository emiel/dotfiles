""
"" Plugins
""

call plug#begin('~/.vim/plugged')
Plug '/opt/local/share/fzf/vim'
Plug 'NLKNguyen/papercolor-theme'
Plug 'ambv/black'
Plug 'elmcast/elm-vim'
Plug 'junegunn/fzf.vim'
Plug 'mileszs/ack.vim'
Plug 'octol/vim-cpp-enhanced-highlight'
Plug 'posva/vim-vue'
Plug 'raichoo/purescript-vim'
Plug 'rhysd/committia.vim'
Plug 'scrooloose/nerdtree'
Plug 'tmhedberg/matchit'
Plug 'tpope/vim-commentary'
Plug 'tpope/vim-fugitive'
Plug 'tpope/vim-git'
Plug 'tpope/vim-markdown'
Plug 'tpope/vim-surround'
Plug 'w0rp/ale'
call plug#end()

filetype plugin indent on

""
"" Global Options
""

set autoindent
set autoread
set backspace=indent,eol,start
set clipboard=unnamed
set confirm
set copyindent
set cursorline
set encoding=utf-8
set formatoptions+=j
set hidden
set history=256
set hlsearch
set ignorecase
set incsearch
set laststatus=2
set lazyredraw
set list
set listchars=tab:>·,trail:·,nbsp:~
set modelines=0
set mouse=a
set nobackup
set nojoinspaces
set pastetoggle=<F10>
set path-=/usr/include
set preserveindent
set ruler
set scrolloff=3
set shell=zsh
set shortmess=at
set showbreak=+++
set showcmd
set showmatch
set smartcase
set smarttab
set spelllang=en_us
set tags=tags;~
set title
set ttyfast
set visualbell
set wildcharm=<C-z>
set wildignore+=*.o,*.pyc
set wildmenu
set wildmode=list:longest

" Prefer ag (The Silver Searcher) over grep
if executable("ag")
    set grepprg=ag\ --vimgrep\ --nogroup\ --nocolor\ $*
    set grepformat=%f:%l:%c:%m
endif

""
"" Mappings
""

let mapleader = ','
nnoremap , <Nop>

" Swap similar keys
nnoremap ' `
nnoremap ` '

" Scroll the viewport faster
nnoremap <c-e> 4<c-e>
nnoremap <c-y> 4<c-y>
vnoremap <c-e> 4<c-e>
vnoremap <c-y> 4<c-y>

" Navigate splits
nnoremap <c-h> <c-w>h
nnoremap <c-j> <c-w>j
nnoremap <c-k> <c-w>k
nnoremap <c-l> <c-w>l

""
"" Completion mappings
""

inoremap <silent> ,f <C-x><C-f>
inoremap <silent> ,i <C-x><C-i>
inoremap <silent> ,l <C-x><C-l>
inoremap <silent> ,n <C-x><C-n>
inoremap <silent> ,o <C-x><C-o>
inoremap <silent> ,t <C-x><C-]>
inoremap <silent> ,u <C-x><C-u>

""
"" Mappings used frequently
""

nnoremap <silent> <leader>stw :<C-U>call StripTrailingWhitespace()<CR>

" Ack
cnoreabbrev Ack Ack!
nnoremap <leader>g :Ack!<SPACE>
nnoremap K :Ack! <cword> *<CR>

" ALE
nnoremap <leader>F :ALEFix<CR>
nnoremap <silent> <C-k> <Plug>(ale_previous_wrap)
nnoremap <silent> <C-j> <Plug>(ale_next_wrap)

" fzf.vim
nnoremap <leader>b :Buffers<CR>
nnoremap <leader>e :e **/*<C-z><S-Tab>
nnoremap <leader>f :Files<CR>
nnoremap <leader>m :Marks<CR>
nnoremap <leader>t :Tags<CR>

" NERDTree
nnoremap <silent> <leader>d :execute 'NERDTreeToggle ' . getcwd()<CR>

" Spell checking
nnoremap <silent> <leader>s :set spell!<CR>

" Toggle pasting...
nnoremap <leader>p :set paste!<CR>:set paste?<CR>

""
"" File type triggers
""

" Jump to last position in file after opening. Nice!
autocmd BufReadPost *
\ if line("'\"") > 0 && line("'\"") <= line("$") |
\   exe "normal! g`\"" |
\ endif

""
"" Colors
""

syntax on

let g:PaperColor_Theme_Options = {
  \   'theme': {
  \     'default': {
  \       'transparent_background': 1
  \     }
  \   }
  \ }

set background=light

colorscheme PaperColor

""
"" Plugins
""

" ack.vim
let g:ack_autoclose = 1
let g:ack_mappings = {
      \  'v':  '<C-W><CR><C-W>L<C-W>p<C-W>J<C-W>p',
      \ 'gv': '<C-W><CR><C-W>L<C-W>p<C-W>J' }

if executable('ag')
  let g:ackprg = 'ag --vimgrep --smart-case -s -H --nocolor --nogroup --column'
endif

" fzf.vim
if (executable('ag'))
    let $FZF_DEFAULT_COMMAND = 'ag --hidden --ignore .git -g ""'
endif

" ALE
let g:ale_statusline_format = ['⨉ %d', '⚠ %d', '⬥ ok']

" NERDTree
let g:NERDTreeIgnore = ['^__pycache__$', '\~$']
